{% extends "backend/base.html" %}
{% block head %}
    {{ super() }}
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/3.8.5/echarts-en.common.js"></script>
    <style>
        .card-body{
            border: #cccccc 2px solid;
            border-radius: 5px;
            padding: 15px;
            margin:20px 0 20px 0;
        }

        .card-body:hover{
            transform: scale(1.01);
        }
    </style>
{% endblock %}
{% block title %}Backend Management System{% endblock %}
{% block content %}
    <main>
        <div class="container">
            <div class="card-body">
                <h4><b>Today's traffic statistics</b></h4>
                <p><i class="fa fa-desktop"></i> Today's new visits: <span class="label label-default">{{ visits }}</span></p>
                <p><i class="fa fa-comment-o"></i> Today's new comments: <span class="label label-default">{{ comments }}</span></p>
                <p><i class="fa fa-heart-o"></i> Today's new likes: <span class="label label-default">{{ likes }}</span></p>
            </div>
            <div class="card-body">
                <h4><b>Trends of 7 days</b></h4>
                <div id="traffic" style="width:100%;height:300px;"></div>
            </div>

        </div>

    </main>
    <script>
        $(document).ready(function (){
            getRecent7DaysDatas();
        })
        function getRecent7DaysDatas(){
            $.ajax({
                url: "/backend/admin/index/",
                type: "post",
                success: function (res){
                    // 基于准备好的dom，初始化echarts实例
                    var myChart = echarts.init(document.getElementById('traffic'));
                    // 指定图表的配置项和数据
                    var option = {
                        tooltip: {},
                        legend: {
                            data:['Visit', 'Comment', 'Like']
                        },
                        xAxis: {
                            data: res.days,
                        },
                        yAxis: {},
                        series: [
                            {
                                name: 'Visit',
                                type: 'bar',
                                data: res.result[0]
                            },
                            {
                                name: 'Comment',
                                type: 'bar',
                                data: res.result[1]
                            },
                            {
                                name: 'Like',
                                type: 'bar',
                                data: res.result[2]
                            },
                        ]
                    };
                    // 使用刚指定的配置项和数据显示图表。
                    myChart.setOption(option);
                }
            })
        }

        /*setTimeout(function (){
	    window.onresize = function () {
	    	myChart.resize();
	    }
	},200)*/

    </script>
{% endblock %}